<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>new branch</title>

<style type="text/css">

   .sign {
    		display: block; /* Блочный элемент */
    		/*float: center; /* Блоки выстраиваются по горизонтали */
    		margin: 0 0px 30px 0; /* Отступы */
    		text-align: left; /* Выравнивание по центру */ 
    	}  
   .sign figcaption {
    					margin: 0; /* Отступы вокруг абзаца */
      				}
   img {
			border: 4px solid #333;
		}
		.border {
    border: 0px solid #333;
   }
	H1 {
			font-family: "Times New Roman", Times, serif; /* Гарнитура шрифта */ 
    		font-size: 300%; /* Размер текста */ 
    		font-weight: bolder; /* Светлое начертание */
    		margin: 0 0px 50px 0; /* Отступы */
		}
	h3 {
			font-family: "Times New Roman", Times, serif; /* Гарнитура шрифта */ 
    		font-size: 150%; /* Размер текста */ 
    		font-weight: bolder; /* Светлое начертание */
    		margin: 0 0px 20px 0; /* Отступы */
		}	
	div {
			margin: 0 0px 20px 0; /* Отступы */
		}	
</style>

<script type="text/javascript" src="../../js/jquery-1.11.2.js"></script>

<script language="javascript">
$(document).ready(function(){
var headermenu = $(".float-menu");
var offset = headermenu.offset();
var left = offset.left;
var top = offset.top;
var width = $(".float-menu").width();
var height = $(".float-menu").height();
 
$(window).scroll(function(){
var scrollTop = $(window).scrollTop();
if (scrollTop > top) {
$('#float').css({
width:width+'px',
height:height+'px'
});
$('.float-menu').css({
left:left+'px',
position:'fixed',
top:"0px",
width:width+"px"
});
} else {
$('#float').css({
width:'0px',
height:'0px'
});
$('.float-menu').css({
position:'static',
});
}
});
});
</script>

<style type="text/css">
.float-menu
{
width:100%;
float:left;
left:0;
}
</style>

<style media='print' type='text/css'>
#navbar-iframe {display: none; height: 0px; visibility: hidden;}
.noprint {display: none;}
body {background:#FFF; color:#000;}
a {text-decoration: underline; color:#00F;}
}
</style>

</head>

<body>

<div class="float-menu" style="height: 52px">
<span class="noprint">
<a class ="print-doc" href="javascript:(print());"><img alt="" class="border" height="32" src="../../img/print.png" width="32" "margin-left: 10px" style="vertical-align:middle"/> Печать</a>
</span>
</div>

<h1>Настройка филиала</h1>
   
<h3>Добавление филиала.</h3>

<div><p>Все действия этого раздела выполняем в данных HTTP-сервера.</p></div>
		<div><img alt="" src="imgB.jpg" /></div>
		
<div><p>Заполнить:</p></div>
		<div><img alt="" src="imgE.jpg" /></div>
<div>
	<ul style="list-style-type: disc">
		<li>Имя филиала – произвольное имя</li>
		<li>Родительский филиал – выбираем Центр</li>
		<li>Адрес – адрес расположения офиса, для удобства.</li>
		<li>IP адрес. Пишем адрес, на котором будет располагаться сервер.</li>
		<li>Порт. 8100 стандартный порт, чтобы не путаться.</li>
	</ul>
</div>	

<div><p>Нажимаем на кнопку <strong>«Создать»</strong>. Откроется мастер создания филиалов. На одном из шагов будет предложено выбрать путь, куда надо сохранить данные филиала.</p></div>

<div><p>Обратить особое внимание к примечанию под этим полем.</p></div>
		<div><img alt="" src="img13.jpg" /></div>

<div><p>Прописываем адреса филиалов: </p></div>
		<div><img alt="" src="img15.jpg" /></div>

<div><p>Адрес центрального всегда <strong>172.29.2.115</strong>, адрес филиального прописываем самостоятельно.</p></div>

<div><p>И нажимаем далее до тех пор, пока не начнут копироваться данные филиала. Может показаться, что программа зависла, но это не так.</p></div>
		<div><img alt="" src="img18.jpg" /></div>

<div><p>После завершения процедуры программа запустится в монопольном режиме. Если этого не произошло – то запускаем в моно вручную.</p></div>

<h3>Очистка Базы данных.</h3>

<div><p>При первом запуске филиальной базы данных во всех учётных записях будет отсутствовать меню. Чтобы его создать заходим в <strong>«Система – Пользователи»</strong> выбираем пользователя <strong>«Администратор»</strong> и нажимаем <strong>«Настройка»</strong> </p></div>
		<div><img alt="" src="img1C.jpg" /></div>

<div><p>А в настройках нажимаем кнопку <strong>«Создать»</strong>.</p></div>

<div><p>Чтобы применить меню надо принудительно сменить пользователя.</p></div>

<div><p>На филиал будут скопированы все данные, что были в исходной базе. Теперь их надо удалить.</p></div>

<div><p>Первым делом – необходимо выключить гребенчатую схему в настройках рабочей станции. Это позволит удалять данные чужого филиала.</p></div>
		<div><img alt="" src="img1F.jpg" /></div>

<div><p>Глубина очистки <strong>«Новый филиал»</strong>. Нажимаем <strong>«Выполнить»</strong>. После завершения очистки обязательно выполнить тест целостности базы данных. В случае ошибок – нажимать кнопку F2. В тесте целостности поставить галочки <strong>«Монотонность сортировки»</strong> и <strong>«Счетчик ссылок»</strong>.</p></div>

<div><p>Обязательно включаем гребенчатую схему!!!!</p></div>

<div><p><strong>Создаём склад в справочнике «Классификаторы – Склады и ячейки – Склады» на филиале.</strong></p></div>

<div>
	<ul style="list-style-type: circle">
		<li>Предварительно создаём стратегию склада.</li>
		<li>Предварительно создаём новое место в справочнике «География» </li>
			<div><img alt="" src="img24.jpg" /></div>		
		<li>Создаём новую запись справочника «Склады»</li>
		<li>Вводим код. WRHX, где Х это порядковый номер филиала. Номера повторяться не должны. Пробела также быть не должно. Также этот код нужно прописать в настройках рабочей станции на сервере и в рабочей станции.</li>
		<li>Вводим наименование склада.</li>
		<li>Выбираем стратегию из ранее созданной.</li>
		<li>На вкладке «разрешения» добавляем все доступные транзакции.</li>
		<li>На вкладке «Географическая информация» выбираем ранее созданное место.</li>
		<li>На вкладке «Интерфейсы» прописываем строку подключения «ODBC:Driver={SQL Server};Server=172.29.2.115\SQLEXPRESS;DataBase=WMS_ERP;UID=sa;PWD=FlvbybcnhfwbZ#;» Естественно меняем адрес сервера</li>
		<li>На вкладке «РФ-технология» ставим галочку «Возможно применение РФ-технологии». Если вдруг в дальнейнем не создаются приказы для склада, сектора или ячейки, то значит отсутствует эта галочка. Так же ставим галочку «Ввод строк в списание».</li>
		<li>Обязательно добавляем привязанный склад Брака. Он может быть без ячеек, но он должен быть для того, чтобы сборщик мог нажимать на кнопку «Брак».</li>
		<li>На вкладке разрешения задаём транзакции «Основную», «Дополнительную», «Региональную».</li>		
	</ul>
</div>	
		
<h3>Запуск сервера филиала.</h3>		
		
<div>
	<ul style="list-style-type: disc">
		<li>В настройках рабочей станции меняем адрес HTTP сервера на адрес филиала.</li>
		<li>В настройках рабочей станции меняем «Директорию данных» ХТТП сервера на «C:\wms\etc\web»</li>
		<li>В настройках рабочей станции меняем «Директория архивного экспорта» на «C:\wms\etc\History»</li>
		<li>В настройках рабочей станции меняем директорию резерва на «C:\wms\etc\backup»</li>
		<li>Помещаем в архив данные филиала и копируем на сервер.</li>
		<li>Также добавляем в архив и отправляем на сервер филиала папки «kernel.x64» и «metaproj».</li>
		<li>На диске С создаём папку «eme» и в неё распаковываем всё, что было скопировано. </li>
		<li>Делаем три копии папки с данными. Называем их так «dat_server», «dat_http», «dat_ws».</li>
		<li>dat_http нужно запустить в моно режиме и сменить настройку рабочей станции «HTTP сервер. IP адрес» прописав там адрес сервера.</li>
		<li>Запускаем db.exe от имени администратора. В поле HDR-файл выбираем файл из папки «dat_server». Сетевой режим ставим «Сервер». И жмём кнопку «Установить сервис». Появится сообщение, что сервис установлен.</li>
		<li>Не закрывая окно db.exe выбираем HDR-файл выбираем файл из папки «dat_http». Сетевой режим «Рабочая станция». Ставим галочку «Мозговой компьютер» и галочку «HTTP-сервер». Снова нажимаем кнопку «Установить сервис». Появится сообщение, что сервис установлен.</li>
		<li>Теперь можно запустить программу «service.exe» и запустить наши службы. Сначала сервер, а потом http.</li>		
		<li>В панели управления компьютера нужно найти службы компьютера и для обеих служб ЕМЕ на вкладке «Восстановление» для полей «Первый сбой», «Второй сбой» и «Последующие сбои» проставить значение «Перезапустить службу».</li>
		<li>В режиме приложения запустить «HTTP-сервер». В настройках планировщика событий сделать неактивным событие «Экспорт», а в параметрах будильника выбрать пункт «Только вручную».</li>
		<li>Открыть HTTP-сервер центрального филиала. Зайти в навигатор канальной схемы – Редактор филиалов. Найти филиал над которым сейчас работали и нажать на кнопку «Подключить». В открывшемся окне сначала пингуем филиал и если есть ответ нажимаем «Ок». </li>
		<li>Там же, в центральном филиале. В навигаторе канальной схемы находим «Информационные трубки» и деактивируем ту, которая идёт от филиала в центр.</li>	
	</ul>
</div>	

<h3>Настройка обмена между 1С и WMS</h3>		

<div>
	<ul style="list-style-type: disc">
		<li>Устанавливаем SQL Express 2008 и SQL Management на сервере филиала (\\172.29.3.115\общие файлы\soft.7z).</li>
				<ol>
					<li style="list-style-type: circle">Если постоянно просит перезагрузки – то http://t-sql.ru/post/A_computer_restart_is_required.aspx</li>
				</ol>		
		<li>В интерфейсе ERP-WMS нужно переформатировать структуру внешней БД.</li>
		<li>Создать файл ERPEngine.xml и положить его в специальную папку на сервере WMS.</li>
		<li>В 1С филиала создаём запись в справочнике «ЕМЕ.ВМС Склады». Указываем путь к файлу данных, контракты, склады, логистов и бухгалтеров. Заполняем почтовые адреса получателей отчётов. Включаем обмен, выгружаем товарные группы и снова выключаем обмен.</li>
	</ul>
</div>	

<h3>Настройка модулей и рабочих станций.</h3>		
	
<div><p>Перед использованием необходимо выполнить дополнительные настройки.</p></div>

<div><p>Настройки модулей выполняются на любой рабочей станции филиала. Настройки рабочей станции – только на той рабочей станции, на которой они должны быть.</p></div>
	
<div>
	<ul style="list-style-type: disc">
		<li>Настройка модулей. «Затирать штрихкод при импорте товара из 1С». Ставим «Да».</li>
		<li>Настройка модулей. «Разрешить с ТСД указывать большее количество». Ставим «Да».</li>
		<li>Настройка модулей. «Отключить учет статусов товаров по срокам жизни». Ставим «Да».</li>
		<li>Настройка модулей. «Можно сканировать минимальную вместо текущий». Ставим «ЛЮБУЮ».</li>
		<li>Настройка модулей. «Приравнять приказ MS-OA к подборке из пикинга». Ставим «Да».</li>
		<li>Настройка модулей. «Подтверждать постановку в ячейку гетеропаллеты». Ставим «Нет».</li>
		<li>Настройка модулей. «Показывать старые пачки заказов». Ставим «Нет».</li>
		<li>Настройка модулей. «Объединение по единицам измерения». Ставим «Да».</li>
		<li>Настройка модулей. «Объединять сроки годности при подборе из одной ячейки». Ставим «Нет».</li>
		<li>Настройка модулей «Учёт в штучках». Ставим «Да».</li>
		<li>Настройка модулей «Не показывать SSCC при инвентаризации». Ставим «Да».</li>
		<li style="list-style-type: none">Полное описание смысла настроек можно найти здесь: Bitrix24\Инструкции ВМС\0) Администратору</li>		
	</ul>
</div>	

<h3>Настройка будильников.</h3>		
	
<div><p>Все действия этого раздела выполняются на хттп-сервере.</p></div>

<div><p>Заходим в «Утилиты БД – Навигатор канальной схемы – Редактор событий».</p></div>

<div><p>Должны быть созданы следующие события:</p></div>
	
<div>
	<ul style="list-style-type: disc">
		<li>Авто списание брака. OffriteBByTimer(). Каждые 3 часа. Списывает брак из ячеек отмеченных зоной брака. </li>
		<li>Автоперевод заказов. RobotRunNextStatus(). Каждые 15 минут. Переводит товары со статуса «Подобран» на статус «Закрыт». Должно выполняться автоматические, но почему-то не всегда происходит. Так что это больше для подстраховки.</li>
		<li>Выгрузка предпросчёта. DoUnderloadsExport(). Каждые 5 минут. Выгружает остатки товара для выполнения предпросчёта. Производится в 12, 14, 16 и 17:45.</li>
		<li>Импорт сообщений ERP. ImportERPMessages(). Каждую минуту. Импортирует данные из 1С.</li>
		<li>Объединение регистров. MergeByTimer(). Ежедневно в любое время. Объединяет регистры. Нужно для корректной подборки товаров, чтобы не было лишних разбиений внутри ячеек.</li>
		<li>Проверка блокировки ячеек. CheckDocumentLock(). Каждый час. Проверяет, заблокированы ли ячейки размещения товаров в документах прихода, для которых запрещён уход.</li>
		<li>Проверка стоковых статусов. MetC_WMS.dll. rf_auto_change_statuses. Ежедневно.</li>
		<li>Рассылка почты. RunReport(). Каждые 8 минут.</li>
		<li>Сборщик мусора в ERP-WMS. RunGarbageCollector(). Удаляет лишние данные. Каждый час.</li>
	</ul>
</div>	

<h3>Рассылка почты.</h3>		
	
<div><p>Для рассылки доступны следующие отчёты:</p></div>
	
<div>
	<ul style="list-style-type: disc">
		<li>ReportControlBBDMail – Контроллинг срока годности. Рассылается раз в неделю по понедельникам.</li>
		<li>MovementFormMail – Содержит перечень товаров, у которых осталось ровно 21 день. Или 5 дней для скоропорта.</li>
		<li>repPercentStockForMail – Содержит перечень товаров, остатки которых менее заданного процента. На данный момент это 45%. Включаются также и те товары, которые имеют, срок годности более указанного процента, но в количестве менее 10 упаковок. Рассылается раз в день.</li>
		<li>repStockAllStatusesForMail - Полный перечень остатков товаров с разбиением про срокам годности. Также содержит информацию об остатках в 1С. Рассылается раз в день.</li>
		<li>SelfDiagMail. Отчёт, содержит данные о складских ошибка. Рассылается раз в день.</li>
		<li>UnderLoadForMail. Количество недогрузов по сводным накладным. Рассылается раз в день.</li>
	</ul>
</div>	

<h3>Заведение транзакций.</h3>		
	
<div><p>Необходимо создать транзакции для прихода, ухода, перемещения и инвентаризации. Следует помнить, что для каждой транзакции должна создаваться собственная стратегия. И собственные параметры поиска ячеек.</p></div>

<div><p>Для прихода нужны минимум 5 транзакций:</p></div>
	
<div>
	<ul style="list-style-type: disc">
		<li>Объединение регистров. <strong><u>ЭТУ ТРАНЗАКЦИЮ СОЗДАЁМ ВРУЧНУЮ ПЕРВОЙ!</u></strong></li>
		<li>102. Приём целых паллет c наклейками.</li>
		<li>111. Приём целых паллет без наклеек</li>
		<li>108. Возврат из торговой точки.</li>
		<li>109. Размещение переупаковки.</li>
	</ul>
</div>	

<div><p>Для ухода нужны следующие транзакции:</p></div>
	
<div>
	<ul style="list-style-type: disc">
		<li>201.Отгрузка по сводным со склада Карьерная</li>
		<li>202.Отгрузка хороших сроков</li>
		<li>204.Отправка на регионы и МСП</li>
		<li>208. Отгрузка день в день (для любого товара)</li>
	</ul>
</div>	

<div><p>Для перемещений нужна:</p></div>
	
<div>
	<ul style="list-style-type: disc">
		<li>305. Свободное перемещение. <strong>НЕ ЗАБЫТЬ НАСТРОИТЬ ПАРАМЕТРЫ ПЕРЕМЕЩЕНИЯ!!!</strong></li>
	</ul>
</div>	

<div><p>Для инвентаризаций:</p></div>
	
<div>
	<ul style="list-style-type: disc">
		<li>401. Блокирующая.</li>
		<li>402. Неблокирующая.</li>		
	</ul>
</div>	

<div><p>Для списания:</p></div>
	
<div>
	<ul style="list-style-type: disc">
		<li>Списание товара из ячеек.</li>
	</ul>
</div>	

<h3>Заведение ячеек.</h3>		

<div>
	<ul style="list-style-type: decimal">
		<li>Классиф. Скл. – разметка – шаблон (сек – кол – ур)</li>
		<li>Задаём № сектора, галку «RF технология», если есть прописываем примечание – сохраняем.</li>
		<li>Для зоны собранных заказов (999) надо указать «Зона ОА в стеллаже»</li>
		<li>На вкладке «Разметка» создаём ячейки: Задаём тип ячеек и указываем </li>
		<li>Для ячеек установить точное сравнение адреса.</li>
	</ul>
</div>	

<h3>Заведение продукции</h3>		
	
<div><p>Установить кратность продажи товаров.</p></div>

<h3>Стратегия продукта</h3>		
	
<div><p>После выгрузки товаров из 1С необходимо подправить параметры стратегии продуктов в соответствии со снимком экрана:</p></div>
			<div><img alt="" src="img35.jpg" /></div>		

<h3>Создание пользователя филиала.</h3>		
	
<div><p>Для того, чтобы на филиале не работали под администратором, необходимо создать учётную запись.</p></div>
			<div><img alt="" src="img38.gif" /></div>		

<div><p>В открывшемся окне нажимаем кнопку «+» и пишем имя пользователя. Как правило это будет слово «Оператор» и название филиала (или склада, если складов на филиале несколько). </p></div>
			<div><img alt="" src="img3C.jpg" /></div>		

<div><p>Импортируем меню для этого пользователя: </p></div>
			<div><img alt="" src="img3F.jpg" /></div>		

<div><p>Файл выбираем по пути «\\172.29.1.167\Distr\EME.WMS\Настройки филиала\Меню оператора EME.emenu»</p></div>

<div><p>В группе галочек «Привилегии» и «Разрешённые операции» проставляем все галочки.</p></div>






</body>

</html>
